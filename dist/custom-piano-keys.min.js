class Pianokeys extends HTMLElement{constructor(){super(),this.t=1,this.s=100,this.i="",this.h=[],this.l=void 0,this.k="red",this.o="circle",this.u=40,this.m=1.5,this.N=this.s*this.m,this.g=this.s,this.p=60,this.v=50,this._=this.N/7,this.M=this.u*this._/100,this.A=this.p*this.g/100,this.K=this.v*this._/100,this.L=2,this.C=this.L*this.s/100,this.B=50,this.I=50,this.V=[1,-1,2,-2,3,4,-3,5,-4,6,-5,7,8,-6,9,-7,10,11,-8,12,-9,13,-10,14,15,-11,16,-12,17,18,-13,19,-14,20,-15,21,22,-16,23,-17,24,25,-18,26,-19,27,-20,28,29,-21,30,-22,31,32,-23,33,-24,34,-25,35,36,-26,37,-27,38,39,-28,40,-29,41,-30,42,43,-31,44,-32,45,46,-33,47,-34,48,-35,49,50,-36,51,-37,52,53,-38,54,-39,55,-40,56],this.H=this.V.length}static get observedAttributes(){return["marked-keys","oct-count","height","mark-color","mark-shape","mark-diameter","b-key-h","b-key-w","stroke-w","b-key-mark-shift","w-key-mark-shift","oct-w-factor"]}disconnectedCallback(){this.l=void 0}attributeChangedCallback(t,s,i){if("oct-count"===t?this.t=Number(i):"height"===t?(this.s=Number(i),this.N=this.s*this.m,this._=this.N/7,this.g=this.s):"marked-keys"===t?(this.i=i,this.h=[]):"mark-color"===t?this.k=i:"mark-diameter"===t?this.u=Number(i):"mark-shape"===t?this.o=i:"b-key-h"===t?this.p=Number(i):"b-key-w"===t?this.v=Number(i):"stroke-w"===t?this.L=Number(i):"b-key-mark-shift"===t?this.B=Number(i):"w-key-mark-shift"===t?this.I=Number(i):"oct-w-factor"===t&&(this.m=Number(i),this.N=this.s*this.m,this._=this.N/7),this.M=this.u*this._/100,this.A=this.p*this.g/100,this.K=this.v*this._/100,this.C=this.L*this.s/100,this.l&&this.P())if("oct-count"===t||"b-key-h"===t||"b-key-w"===t||"stroke-w"===t||"oct-w-factor"===t||"height"===t)this.removeChild(this.querySelector("svg")),this.appendChild(this.G()),this.l=this.querySelector("#keys"),this.R(),(this.i||this.h.length>0)&&this.T(this.i,this.h);else if("marked-keys"===t||"mark-color"===t||"mark-shape"===t||"mark-diameter"===t||"b-key-mark-shift"===t||"w-key-mark-shift"===t){for(;null!==this.l.querySelector(".keymark");)this.l.removeChild(this.l.querySelector(".keymark"));this.T(this.i,this.h)}}connectedCallback(){this.P()&&(this.appendChild(this.G()),this.l=this.querySelector("#keys"),this.R(),this.hasAttribute("marked-keys")&&this.T(this.getAttribute("marked-keys")))}setMarkedKeys(t){if(Array.isArray(t)){for(;null!==this.l.querySelector(".keymark");)this.l.removeChild(this.l.querySelector(".keymark"));t.length>0&&this.W(t),this.h=t.slice(),this.i=""}}P(){return!(isNaN(this.t)||isNaN(this.s)||isNaN(this.m)||isNaN(this.u)||isNaN(this.L)||isNaN(this.p)||isNaN(this.v)||isNaN(this.B)||isNaN(this.I))}R(){var t=this.t*this.m*this.s;this.l.style.height=this.s+"px",this.l.style.width=t+"px",this.l.style.verticalAlign="middle"}T(t,s=[]){if(0!==t.length||0!==s.length)if(s.length>0)this.W(s);else{var i=t.trim().split(/\s+/).map(t=>parseInt(t)).filter(this.X,this);0!==i.length&&this.W(i)}}W(t){var s,i=12*this.t,h=this._/2,e=this.A+(this.g-this.A)*this.I/100,r=this.A*this.B/100,a=0,l=0,k=this.k,n=[];this.Z(n);for(let o=0;o<t.length&&!(t[o]>i);o++)(s=this.V[t[o]-1])<0?(a=n[Math.abs(s)-1],l=r,"black"!==this.k&&"#000000"!==this.k||(k="white")):(a=s*this._-h,l=e,"black"!==this.k&&"#000000"!==this.k||(k="black")),"rect"===this.o?this.j(a,l,k,this.M):this.q(a,l,k,this.M)}q(t,s,i,h){const e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.setAttributeNS(null,"fill",i),e.setAttributeNS(null,"r",h/2),e.setAttributeNS(null,"cx",t),e.setAttributeNS(null,"cy",s),e.setAttributeNS(null,"class","keymark"),this.l.appendChild(e)}j(t,s,i,h){const e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttributeNS(null,"fill",i),e.setAttributeNS(null,"x",t-h/2),e.setAttributeNS(null,"y",s-h/2),e.setAttributeNS(null,"width",h),e.setAttributeNS(null,"height",h),e.setAttributeNS(null,"class","keymark"),this.l.appendChild(e)}G(){var t=7*this.t-1,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"id","keys"),s.setAttributeNS(null,"width",this.t*this.N),s.setAttributeNS(null,"height",this.g),s.setAttributeNS(null,"viewBox","0 0 "+this.t*this.N+" "+this.g);var i=document.createElementNS("http://www.w3.org/2000/svg","path"),h=this.C/2;return i.setAttributeNS(null,"d","M"+h+" "+h+" L"+h+" "+(this.g-h)+" L"+(this.t*this.N-h)+" "+(this.g-h)+" L"+(this.t*this.N-h)+" "+h+" Z"),i.setAttributeNS(null,"stroke","black"),i.setAttributeNS(null,"stroke-width",this.C),i.setAttributeNS(null,"fill","white"),s.appendChild(i),this.D(s,t),this.F(s),s}Z(t){var s=[this._,this._,2*this._,this._,this._,2*this._],i=0,h=0;for(let e=0;e<5*this.t;e++)t[e]=s[i]+h,h=t[e],++i>5&&(i=1)}F(t){var s,i=[];this.Z(i);var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"stroke","black"),h.setAttributeNS(null,"stroke-width",this.K);for(let e=0;e<5*this.t;e++)(s=h.cloneNode()).setAttributeNS(null,"d","M"+i[e]+" 0 L"+i[e]+" "+this.A),t.appendChild(s)}D(t,s){var i,h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"stroke","black"),h.setAttributeNS(null,"stroke-width",this.C),h.setAttributeNS(null,"d","M"+this._+" 0 L"+this._+" "+this.g),t.appendChild(h);var e=2*this._;for(let r=1;r<s;r++)(i=h.cloneNode()).setAttributeNS(null,"d","M"+e+" 0 L"+e+" "+this.g),t.appendChild(i),e+=this._}X(t){return!(isNaN(t)||"number"!=typeof t||t<1||t>this.H)}}customElements.define("custom-piano-keys",Pianokeys);